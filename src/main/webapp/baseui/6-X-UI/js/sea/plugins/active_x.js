define("./active_x",["./component"],function(f){var f=f("./component"),h=function(c,d){for(var a in c)typeof c[a]=="function"&&a!="handleException"&&(c[a]=_.wrap(c[a],function(a){try{return a.apply(c,Array.prototype.slice.call(arguments,1))}catch(b){return d.call(c,b)}}))},g=f.extend({el:null,ocxEl:null,constructor:function(c,d,a){var e=c.el.attr("id");if(e)this.no=function(){return"ocx_"+e};d==null?d=["hikui-active"]:d.push("hikui-active");h(this,function(b){if(this.handleException)return this.handleException(b);
b=this.msgEl||this.el;this.ocxEl!=null&&this.ocxEl.hide();b.find('div[msgType="msg"]').remove();b.find("*").hide();var a=['<div class="msg-b msg-b-stop"><i></i><div class="msg-cnt">'];a.push("<span>"+language.text("ocx.error")+"</span>");if(this.getOcxUrl!=null){var c=null;if(typeof this.getOcxUrl=="function")c=this.getOcxUrl();else if(typeof this.getOcxUrl=="string")c=this.getOcxUrl;this.id.indexOf("swf_schedule")>-1?(a.push("<p>"),a.push(language.text("flash.error")),a.push("</p>")):c!=null&&(a.push("<p>"),
a.push(language.text("ocx.load")),a.push("</p>"))}a.push("</div></div>");b.append(a.join(""));return!1});this.base(c,d,a)},render:function(c,d,a,e){if(loader)loader.change=function(a){a.readyState==4&&loader&&(loader.hide(),delete loader.change)};this.ocxEl=$.browser.msie||~navigator.userAgent.search(/Trident/i)?this.el.find("object"):this.el.find("embed");if(!this.ocxEl.length){var b=['<object classid="',c,'" width="100%" onreadystatechange="loader.change(this)" height="100%" id="',this.no(),'" name="',
this.no(),'"'];this.codebase&&(!a&&!e?b.push(['CODEBASE="',d||"","/web/softs/HIKOCX.CAB#version=",this.codebase,'"'].join("")):a&&!e?b.push(['CODEBASE="',d||"","/web/softs/",a,"#version=",this.codebase,'"'].join("")):!a&&e?b.push(['CODEBASE="',d||"",e,"HIKOCX.CAB#version=",this.codebase,'"'].join("")):b.push(['CODEBASE="',d||"",e,a,"#version=",this.codebase,'"'].join("")));b.push(">");this.params&&$.each(this.params,function(a,c){b.push('<param name="');b.push(a);b.push('" value="');b.push(c);b.push('">')});
d=this.no().split("_");a=d.length;b.push(['<embed type="'+c+'" width="100%" height="100%" onreadystatechange="loader.change(this)" id="embed_'+this.no()+'" name="'+this.no()+'"windowid="'+d[a-1]+'"']);b.push(">");b.push("</object>");this.el.html(b.join(""));this.ocxEl=$.browser.msie||~navigator.userAgent.search(/Trident/i)?this.el.find("object"):this.el.find("embed")}},throwError:function(c){throw Error(c);},destroy:function(){this.ocxEl!=null&&(this.ocxEl.hide(),this.ocxEl.remove());this.base()}});
g.BASE_URL=f.BASE_URL;return g});
